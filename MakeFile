# Makefile

.PHONY: all install-service install-venv clean

# Default target
all: install-venv install-service

# Create and activate virtual environment, install dependencies
install-venv:
	@echo "Creating virtual environment..."
	python3 -m venv venv
	@echo "Activating virtual environment and installing dependencies..."
	venv/bin/pip install --upgrade pip
	venv/bin/pip install -r requirements.txt

# Install systemd service
install-service:
	@echo "Installing systemd service..."
	sudo cp jobbot.service /etc/systemd/system/jobbot.service
	sudo systemctl daemon-reload
	sudo systemctl enable jobbot.service
	sudo systemctl start jobbot.service

# Clean up virtual environment and service files
clean:
	@echo "Cleaning up..."
	rm -rf venv
	sudo rm /etc/systemd/system/jobbot.service
	sudo systemctl daemon-reload
	sudo systemctl stop jobbot.service
